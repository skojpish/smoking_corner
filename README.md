# Smoking Corner

## Описание
Smoking Corner - это RESTfull сервис бронирования мест для курения. Сервис позволяет бронировать места в зонах для курения. Каждый пользователь может иметь только
одну бронь в каждый момент времени (нельзя забронировать два места для курения
так, чтобы время бронирования этих мест пересекались). Место для курения может
иметь только одну бронь в каждый момент времени. Длительность бронирования не
может превышать 30 минут.

## Права доступа
Чтобы пользовать сервисом пользователю необходимо зарегестрироваться по пути /registration

В данном проекте реализованы 2 возможные роли у пользователей: "user" и "admin". Роль "user" присваивается всем новым пользователям автоматически.

Пользователи с ролью "user" могут:
- просматривать места для курения и их статус
- видеть запланированные брони других пользователей
- добавлять/изменять/удалять собственные брони

Пользователи с ролью "admin" могут дополнительно:
- добавлять/изменять/удалять адреса мест для курения
- добавлять/изменять/удалять места для курения
- просматривать список всех пользователей
- назначать других пользователей администраторами
- удалять пользователей
- удалять брони

## Эндпоинты и HTTP методы
Краткая справка по эндпоинтам, которые содержит проект

Публичные эндпоинты:
- POST /registration - регистрация нового пользователя (пароли хэшируются с добавлением "соли")

Эндпоинты для аутентифицированных пользователей:
- GET /smoking-places - вывод всех мест для курения со статусом (занята до ... / свободна)
- GET /smoking-places/{sp_id} - вывод места для курения по его id
- GET /reservations - вывод броней других пользователей
- GET /reservations/my-reservations - вывод броней аутентифицированного пользователя
- GET /reservations/my-reservations/{res_id} - вывод одной брони аутентифицированного пользователя
- POST /smoking-places/{sp_id}/reservation - создание брони в выбранном месте для курения
- PUT /reservations/my-reservations/{res_id} - изменение (или создание, если отсутствует) брони по id
- DELETE /reservations/my-reservations/{res_id} - удаление своей брони

Эндпоинты для администраторов:
- GET /admin/addresses - вывод всех адресов мест для курения с  их количеством для каждого адреса 
- GET /admin/addresses/{address_id} - вывод адреса по его id
- GET /admin/addresses/{address_id}/smoking-places - вывод всех мест для курения на адресе
- GET /admin/addresses/{address_id}/smoking-places/{sp_id} - вывод места для курения по его айди
- GET /admin/users - вывод всех пользователей
- GET /admin/users/{user_id} - вывод конкретного пользователя
- GET /admin/reservations - вывод всех броней
- GET /admin/reservations/{res_id} - вывод брони по id
- POST /admin/addresses/new-address - добавление нового адреса
- POST /admin/addresses/{address_id}/smoking-places/new-smoking-place - добавление нового места для курения
- PUT /admin/addresses/{address_id} - изменение или создание адреса по id
- PUT /admin/addresses/{address_id}/smoking-places/{sp_id} - изменение или создание места для курения по id
- PATCH /admin/users/{user_id} - изменение роли выбранного пользователя
- DELETE /admin/addresses/{address_id} - удаление адреса
- DELETE /admin/addresses/{address_id}/smoking-places/{sp_id} - удаление места для курения
- DELETE /admin/users/{user_id} - удаление пользователя (если он не администратор)
- DELETE /admin/reservations/{res_id} - удаление брони по id

## Некоторые особенности 
1) В качестве метода аутентификации используется BasicAuth
2) Написана middleware для проверки аутентификации пользователей при каждом запросе
3) Данные между слоями передаются при помощи DTO (описаны в модуле src.schemas) 
